<project default="main">

	<!--
		Steps
	 	Ant properties available at runtime: 
	
	 - eclipse.pdebuild.scripts: the org.eclipse.eclipse.pdebuild.scripts folder
	 - eclipse.pdebuild.home: the root folder of pde build
	 - eclipse.pdebuild.templates: the  templates folder
	
	-->

	<!--build monitoring information:  e-mail, smtp server, build label-->
	<property file="monitor.properties"/>
	
	<!--location of PDE Build configuration files for builder and packager-->
	<property name="eclipse.build.configs" value="${basedir}/eclipse/buildConfigs" />
	
	<property name="base.builder" value="${basedir}/../org.eclipse.releng.basebuilder" />
	
	<!--location of properties file containing last tag used for integration build-->
	<property name="mapTag.properties" value="/home/users/releng/buildTools/eclipse33/mapTag.properties"/>
	
	
	<!--default buildDirectory-->
	<property name="buildDirectory" value="${basedir}/../src" />
	
	<!--default location for build output, parent to ${buildId}-->
	<property name="postingDirectory" value="${buildDirectory}" />

    <!--remote sign machine login infomation-->
    <property name="username.sign" value="" />
    <property name="password.sign" value="" />
    <property name="hostname.sign" value="" />
    <property name="home.dir" value="" />
    <property name="sign.dir" value="" />

	<target name="main" depends="init">
		
		<antcall target="buildBirtThirdPartyFeature"/>
		<antcall target="buildBirtFeature"/>
		<antcall target="buildBirtOSGI"/>
		<antcall target="fetchBirtWtpFeature"/>
		<antcall target="fetchRCP"/>
		<antcall target="buildBirtRCPFeature"/>
		<antcall target="buildBirtTestFeature"/>
		<antcall target="unpackUpdateJarsForPackaging"/>
		<antcall target="buildBirtWebViewer"/>
		<antcall target="BuildChartViewer"/>
		<antcall target="CreateDistribute"/>
		
		<parallel failonany="true">
			<sequential>	
				<antcall target="buildBirtWtpFeature"/>
			</sequential>
			<sequential>
				<antcall target="buildBirtNLFeature"/>			
				<antcall target="iPortalSetup"/>
			</sequential>
		</parallel>

		<antcall target="verifyCompile"/>
		<antcall target="CreateUpdateSite"/>
		
		<parallel failonany="true">
			<sequential>
		        <antcall target="runBirtTest"/>
			</sequential>
			<sequential>		
				<antcall target="generateJavaCrossReference"/>
				<antcall target="generateDocumentCheck"/>
				<antcall target="generateJavaDoc"/>   
			</sequential>
		</parallel>	
	</target>

	<target name="init">
		
		<ant antfile="build.xml" target="init" />
		
		<property file="${buildDirectory}/label.properties" />
		
		<condition property="fetchTag" value="HEAD">
			<equals arg1="${buildType}" arg2="N" />
		</condition>
		
		<condition property="forceContextQualifier" value="${buildId}">
			<equals arg1="${buildType}" arg2="N" />
		</condition>
		
		<condition property="generateFeatureVersionSuffix" value="false">
			<equals arg1="${buildType}" arg2="N" />
		</condition>
		
		<condition property="createUpdateSite" value="true">
			<equals arg1="${buildType}" arg2="I" />
		</condition>
		
		<!--compiler args-->
		<property name="compilerArg" value="-enableJavadoc -encoding utf-8 -warn:-discouraged,forbidden" />
		<property name="javacSource" value="1.5" />
		<property name="javacTarget" value="1.5" />
		<property name="javacDebugInfo" value="true" />
		<property name="javacFailOnError" value="false" />
		<property name="javacVerbose" value="false" />
		<property name="logExtension" value=".xml" />
		<!--this property required as of Eclipse 3.0 stream builds > 20031126 -->
		<property name="buildingOSGi" value="true" />
		<!--zip args-->
		<property name="zipargs" value="-y -qq" />
		<!--unzip args-->
		<property name="unzipArgs" value="-qq" />
	</target>
	
	<target name="buildBirtFeature">
        <tstamp prefix="timestamp">
            <format property="sdk.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.sdk.start}]-BIRT sdk feature build started" file="${basedir}/monitor.log"/>
		
		<ant antfile="build.xml" dir="${basedir}">
			<property name="component" value="${eclipse.build.configs}/birt" />
        </ant>
		
        <tstamp prefix="timestamp">
            <format property="sdk.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.sdk.end}]-BIRT sdk feature build finished" file="${basedir}/monitor.log"/>
	</target>

	<target name="buildBirtOSGI" unless="skip.build.OSGI">
        <tstamp prefix="timestamp">
            <format property="osgi.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.osgi.start}]-BIRT OSGI sdk feature build started" file="${basedir}/monitor.log"/>
		
		<ant antfile="build.xml" dir="${basedir}">
			<property name="component" value="${eclipse.build.configs}/birt.osgi" />
		</ant>
		
        <tstamp prefix="timestamp">
            <format property="osgi.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
	    <echo message="[${timestamp.osgi.end}]-BIRT OSGI sdk feature build finished" file="${basedir}/monitor.log"/>
	</target>
		
	
	<target name="CreateDistribute">
        <tstamp prefix="timestamp">
            <format property="package.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.package.start}]-Packaging started" file="${basedir}/monitor.log"/>
		
		<mkdir dir="${postingDirectory}/${buildId}"/>
		
		<!-- generate genReport.sh/.bat for birt-runtime-package -->
		<property name="template.dir" value="${baseLocation}/../PackageFiles/template"/>
		<delete>
			<fileset dir="${template.dir}/engine.runtime.bin">
				<include name="*.*"/>
			</fileset>
		</delete>
		
		<exec executable="${eclipse.build.configs}/../../extras/genReportGenerator.sh">
			<arg line="${buildDirectory}/${buildId}/birt_web/org.eclipse.birt.report.viewer/birt_web/WEB-INF/platform/lib" />
			<arg line="${template.dir}/engine.runtime.bin" />
		</exec>
		<!-- create Runtime -->
		<property file="${buildDirectory}/finalPluginsVersions.properties"/>
		
		<!-- copy runtime to ${buildDirectory}/${buildId}/eclipse/plugins/org.eclipse.birt.integration.wtp_${org.eclipse.birt.integration.wtp}/runtime -->

		<ant antfile="BIRTDownloadSetup.xml" dir="${eclipse.build.configs}/birt/tools" target="createWebViewerExample">
			<property name="OutputDir" value="${buildDirectory}/plugins/org.eclipse.birt.integration.wtp.ui/runtime" />
			<property name="deposit" value="${buildDirectory}/${buildId}" />
		</ant>

		
		<!-- copy chart runtime to ${buildDirectory}/${buildId}/eclipse/plugins/org.eclipse.birt.chart.integration.wtp.ui_${org.eclipse.birt.chart.integration.wtp.ui}/runtime
		 -->
		

		<ant antfile="BIRTDownloadSetup.xml" dir="${eclipse.build.configs}/birt/tools" target="createChartViewer">
			<property name="runtime.tmp" value="${buildDirectory}/plugins/org.eclipse.birt.chart.integration.wtp.ui/runtime" />
		</ant>

		
		<!-- fix bugzilla bug 225500 -->

		<property name="temp.dir" value="${buildDirectory}/plugins/org.eclipse.birt.chart.integration.wtp.ui/runtime"/>
		<mkdir dir="${temp.dir}/chart-viewer-sample"/>
		<exec executable="unzip" dir="${temp.dir}/">
            <arg line="-q chart-viewer-sample.war -d ${temp.dir}/chart-viewer-sample" />
        </exec>
		
		<delete file="${temp.dir}/chart-viewer-sample.war" failonerror="false"/>
		<delete file="${temp.dir}/chart-viewer-sample/WEB-INF/web.xml" failonerror="false"/>

        <exec executable="/bin/sh" dir="${temp.dir}/chart-viewer-sample">
            <arg value="-c"/>
            <arg value="zip -r -q ${temp.dir}/chart.zip *" />
        </exec>

		<delete dir="${temp.dir}/chart-viewer-sample" failonerror="false"/>

		<!-- create AllInOne,AllInOne for Linux, RCP, FrameworkSDK,Framework,Chart,BIRTSample,TestSuite,Database -->
		<ant antfile="BIRTDownloadSetup.xml" dir="${eclipse.build.configs}/birt/tools" target="default">
			<property name="OutputDir" value="${postingDirectory}/${buildId}" />
			<property name="deposit" value="${buildDirectory}/${buildId}" />
		</ant>
		
        <tstamp prefix="timestamp">
            <format property="package.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.package.end}]-Packaging finished" file="${basedir}/monitor.log"/>
		

	</target>

	<target name="sendNotification" unless="nomail">
		<!-- copy directory.txt to output directory -->
		<copy tofile="${postingDirectory}/${buildId}/directory.txt" file="${buildDirectory}/directory.txt"/>
		<copy tofile="${postingDirectory}/monitor.properties" file="monitor.properties" overwrite="true" />
		<copy tofile="${postingDirectory}/finalPluginsVersions.properties" file="${buildDirectory}/finalPluginsVersions.properties" overwrite="true" />
		<copy tofile="${postingDirectory}/finalFeaturesVersions.properties" file="${buildDirectory}/finalFeaturesVersions.properties" overwrite="true" />
        <!--copy build and update dtp log to output directory-->
        <copy todir="${postingDirectory}/${buildId}">
            <fileset dir="." includes="*.log"/>
        </copy>
		<!-- Send build ready mail to QA -->
		<ant antfile="${eclipse.build.configs}/../helper.xml" target="InformQA"/>
	</target>
	
	<target name="iPortalSetup">
		<ant antfile="BIRTDownloadSetup.xml" dir="${eclipse.build.configs}/birt/tools" target="createIpotalLib">
			<property name="OutputDir" value="${postingDirectory}/${buildId}" />
			<property name="deposit" value="${buildDirectory}/${buildId}" />
		</ant>
	</target>
	
	<target name="renameBirtPackage" unless="skip.rename.package">
		<move file="${postingDirectory}/${buildId}/birt-charts-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-charts-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-database-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-database-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-rcp-report-designer-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-rcp-report-designer-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-report-designer-all-in-one-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-report-designer-all-in-one-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-report-designer-all-in-one-${package.version}-linux-gtk.tar.gz"
        tofile="${postingDirectory}/${buildId}/birt-report-designer-all-in-one-${package.version}-${build.date}-linux-gtk.tar.gz"/>
		<move file="${postingDirectory}/${buildId}/birt-report-framework-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-report-framework-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-report-framework-sdk-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-report-framework-sdk-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-runtime-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-runtime-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-sample-plugins-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-sample-plugins-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-source-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-source-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-tests-suite-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-tests-suite-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/birt-wtp-integration-sdk-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/birt-wtp-integration-sdk-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1_FeatureOverlay-birt-charts-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1_FeatureOverlay-birt-charts-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1_FeatureOverlay-birt-rcp-report-designer-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1_FeatureOverlay-birt-rcp-report-designer-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1_FeatureOverlay-birt-report-all-in-one-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1_FeatureOverlay-birt-report-all-in-one-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1_FeatureOverlay-birt-report-framework-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1_FeatureOverlay-birt-report-framework-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1-birt-charts-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1-birt-charts-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1-birt-rcp-report-designer-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1-birt-rcp-report-designer-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1-birt-report-designer-all-in-one-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1-birt-report-designer-all-in-one-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1-birt-report-framework-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1-birt-report-framework-${package.version}-${build.date}.zip"/>
		<move file="${postingDirectory}/${buildId}/NLpack1-birt-runtime-${package.version}.zip"
                    tofile="${postingDirectory}/${buildId}/NLpack1-birt-runtime-${package.version}-${build.date}.zip"/>
	</target>
	
	<target name="CreateUpdateSite" if="updateSite">
		
		<property name="updateJarWorkingDir" value="${buildDirectory}/updateJars" />
		<property name="compsite.site" value="${buildDirectory}/../../UpdateSite/${updateSite}" />
		<property name="repo" value="${compsite.site}/${buildId}" />
		<mkdir dir="${updateJarWorkingDir}" />
		<mkdir dir="${updateJarWorkingDir}/site" />
		
        <exec executable="unzip" dir="${buildDirectory}">
            <arg line="-o -q birt-all-${package.version}.bak.zip -d ${updateJarWorkingDir}" />
        </exec>
		<exec executable="unzip" dir="${buildDirectory}">
			<arg line="-o -q birt-all-${package.version}.sign.zip -d ${updateJarWorkingDir}" />
		</exec>
	
		<exec executable="unzip" dir="${buildDirectory}/${buildId}">
			<arg line="-o -q birt-wtp-integration-sdk-${package.version}.zip -d ${updateJarWorkingDir}" />
		</exec>
		
		<exec executable="unzip" dir="${buildDirectory}/${buildId}">
			<arg line="-o -q birt-nl-${package.version}.zip -d ${updateJarWorkingDir}" />
		</exec>
		<exec executable="unzip" dir="${buildDirectory}/${buildId}">
			<arg line="-o -q birt-dtp-nl-${package.version}.zip -d ${updateJarWorkingDir}" />
		</exec>		

		<delete includeemptydirs="true">
			<fileset dir="${updateJarWorkingDir}/eclipse/features">
				<include name="org.eclipse.birt.sdk*/**"/>
				<include name="org.eclipse.birt.integration.wtp.sdk*/**"/>
				<include name="com.lowagie.itext*/**"/>
				<include name="org.apache.commons.codec*/**"/>
				<include name="org.apache.derby.core*/**"/>
				<include name="org.eclipse.birt.chart.runtime*/**"/>
				<include name="org.eclipse.birt.crosstab*/**"/>
			    <include name="org.eclipse.birt.report.data.oda.jdbc.dbprofile*/**"/>
				<include name="org.eclipse.birt.report.designer.debug*/**"/>
				<include name="org.eclipse.birt.report.designer_*/**"/>
				<include name="org.eclipse.birt.report.designer.source_*/**"/>
				<include name="org.eclipse.birt.report.runtime_*/**"/>
				<include name="org.eclipse.birt.report.runtime.source_*/**"/>
				<include name="org.eclipse.birt.thirdparty*/**"/>
				<include name="org.mozilla.rhino*/**"/>
				<include name="org.w3c.sac*/**"/>
			</fileset>
			<fileset dir="${updateJarWorkingDir}/eclipse/plugins">
				<include name="*.thirdparty*/**"/>
				<include name="org.eclipse.birt.chart.runtime_*.jar"/>
				<include name="org.eclipse.birt.chart.runtime.source_*.jar"/>
				<include name="org.eclipse.birt.report.runtime_*.jar"/>
				<include name="org.eclipse.birt.report.runtime.source_*.jar"/>
				<include name="org.eclipse.birt.report.designer_*.jar"/>
				<include name="org.eclipse.birt.report.designer.source_*.jar"/>
			</fileset>	
		</delete>
		
		<!-- repack update jar -->
		<replace file="${eclipse.build.configs}/../../extras/pack200" token="@pack200@" value="${jvm15_home}/bin/pack200"/>
		<chmod file="${eclipse.build.configs}/../../extras/pack200" perm="755"/>

		<exec executable="dos2unix" dir="${eclipse.build.configs}/../../extras">
			<arg line=" pack200" />
		</exec>
		
		<antcall target="generateCategory"/>
		<!-- TODO: generate p2 composite update site -->
        <antcall target="GenP2CompositeUpdateSite"/>
                
		<!-- TODO: generate birt-updatesite package -->
		<antcall target = "GenUpdatesitePackage"/>
		
		
	</target>

        <target name="GenP2CompositeUpdateSite">
            <property name="p2.repo.name" value="BIRT TEST" />
            <mkdir dir="${repo}" />
            
            <!-- generate pack200 -->
            <java jar="${basedir}/../org.eclipse.releng.basebuilder/plugins/org.eclipse.equinox.launcher.jar"
                  fork="true"
                  timeout="10800000"
                  jvm="${jvm15_home}/bin/java"
                  failonerror="true"
                  maxmemory="512m"
                  dir="${updateJarWorkingDir}">
                  <jvmarg value="-Dorg.eclipse.update.jarprocessor.pack200=${eclipse.build.configs}/../../extras"/>
                  <arg line="-application org.eclipse.update.core.siteOptimizer -verbose"/>
                  <arg line="-jarProcessor -outputDir ${updateJarWorkingDir}/site -processAll -pack eclipse"/>
            </java>

            <!--generator features and plugins metadata -->
            <!--p2.generator source="${repo}" compress="true" append="true" flavor="tooling"
                          metadataRepository="file:${repo}"
                          artifactRepository="file:${repo}"
                          metadataRepositoryName="${p2.repo.name}"
                          artifactRepositoryName="${p2.repo.name}"
                          publishArtifacts="true" p2OS="linux" mode="incremental"
                          site="file:${updateJarWorkingDir}/site/site.xml"/-->
            <copy file="${updateJarWorkingDir}/site/site.xml" todir="${repo}"/>
            <java jar="${basedir}/../org.eclipse.releng.basebuilder/plugins/org.eclipse.equinox.launcher.jar"
                  fork="true"
                  timeout="10800000"
                  jvm="${jvm15_home}/bin/java"
                  failonerror="true"
                  maxmemory="512m">
                  <arg line="-application org.eclipse.equinox.p2.publisher.UpdateSitePublisher"/>
                  <arg line="-metadataRepository file:${repo}"/>
                  <arg line="-artifactRepository file:${repo}"/>
                  <arg line="-source ${updateJarWorkingDir}/site"/>
                  <arg line="-configs gtk.linux.x86"/>
                  <arg line="-compress"/>
            	  <arg line="-reusePack200Files"/>
                  <arg line="-publishArtifacts"/>
            </java>
        	<copy todir="${repo}/features">
        	   <fileset dir="${updateJarWorkingDir}/site/features" includes="*.pack.gz"/>
        	</copy>
            
            <!--try create composite repository-->
            <p2.composite.artifact.repository.create location="file://${compsite.site}" name="${p2.repo.name}" compressed="true" failOnExists="false" />
            <p2.composite.metadata.repository.create location="file://${compsite.site}" name="${p2.repo.name}" compressed="true" failOnExists="false" />

            <!--add childRepo to composite repo-->
            <p2.composite.artifact.repository.add location="file://${compsite.site}" child="${buildId}" />
            <p2.composite.metadata.repository.add location="file://${compsite.site}" child="${buildId}" />

        </target>
	
	<target name="generateCategory">

		<property name="updateJarWorkingDir" value="${buildDirectory}/updateJars" />
	    <!-- generate site.xml -->
	    <property file="${buildDirectory}/finalFeaturesVersions.properties"/>
	    <copy file="${eclipse.build.configs}/../../extras/site.xml" tofile="${updateJarWorkingDir}/site/site.xml"/>
	    <!-- replace the feature version in site.xml -->
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.cshelp}" token="@FEATURE.BIRT.CSHELP@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.example}" token="@FEATURE.BIRT.EXAMPLE@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.doc.isv}" token="@FEATURE.BIRT.DOC.ISV@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.source}" token="@FEATURE.BIRT.SOURCE@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt}" token="@FEATURE.BIRT@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.chart}" token="@FEATURE.CHART@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.doc}" token="@FEATURE.BIRT.DOC@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.chart.cshelp}" token="@FEATURE.CHART.CSHELP@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.chart.doc.isv}" token="@FEATURE.CHART.DOC.ISV@"/>
	    <replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.chart.source}" token="@FEATURE.CHART.SOURCE@"/>
		<replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.osgi.runtime.sdk}" token="@FEATURE.OSGI.RUNTIME.SDK@"/>
		<replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.chart.integration.wtp}" token="@FEATURE.CHART.WTP@"/>
		<replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.chart.integration.wtp.source}" token="@FEATURE.CHART.WTP.SOURCE@"/>
		<replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.integration.wtp}" token="@FEATURE.BIRT.WTP@"/>
		<replace file="${updateJarWorkingDir}/site/site.xml" value="${org.eclipse.birt.integration.wtp.source}" token="@FEATURE.BIRT.WTP.SOURCE@"/>		
	</target>
	
	<target name="GenUpdatesitePackage">

		<zip destfile="${postingDirectory}/${buildId}/birt-updatesite-${package.version}.zip">
		   <fileset dir="${repo}">
		       <include name="features/**"/>
		       <include name="plugins/**"/>
		   </fileset>
		</zip>
		
		<antcall target="renameBirtUpdatesitePackage"/>
		
		<!-- push update site to output directory -->
		<!--mkdir dir="${postingDirectory}/${buildId}/UpdateSite/plugins"/>
		<mkdir dir="${postingDirectory}/${buildId}/UpdateSite/features"/>
		<copy todir="${postingDirectory}/${buildId}/UpdateSite/plugins">
			<fileset dir="${updateJarWorkingDir}/site/plugins">
				<include name="**"/>
			</fileset>
		</copy>
		
		<copy todir="${postingDirectory}/${buildId}/UpdateSite/features">
			<fileset dir="${updateJarWorkingDir}/site/features">
				<include name="**"/>
			</fileset>
		</copy>
		
		<copy tofile="${postingDirectory}/${buildId}/UpdateSite/site.xml" 
			file="${updateJarWorkingDir}/site/site.xml" overwrite="true"/>
		
        <property name="compsite.site" value="${postingDirectory}/../../../UpdateSite/${updateSite}" />
        <property name="repo" value="${compsite.site}/${buildId}" />

	    <copy todir="${postingDirectory}/${buildId}/UpdateSite/">
	        <fileset dir="${repo}">
	            <include name="*.jar"/>
	        </fileset>
	    </copy-->
		
	</target>
	
	<target name="renameBirtUpdatesitePackage" unless="skip.rename.package">
			<move file="${postingDirectory}/${buildId}/birt-updatesite-${package.version}.zip"
			      tofile="${postingDirectory}/${buildId}/birt-updatesite-${package.version}-${build.date}.zip"/>
	</target>
	
	<target name="runBirtTest" unless="skip.unit.test">
		<ant antfile="${eclipse.build.configs}/../helper.xml" target="runBirtTest" >
			<property name="runner.dir" value="${eclipse.build.configs}/birt.tests/test.scripts" />
		</ant>
		<ant antfile="${eclipse.build.configs}/../helper.xml" target="InformAutomation" >
			<property name="runner.dir" value="${eclipse.build.configs}/birt.tests/test.scripts" />
		</ant>

		<ant antfile="${eclipse.build.configs}/../helper.xml" target="genTestResultSummary" />
	</target>
	
	<target name="runBirtPerformance">
		<ant antfile="${eclipse.build.configs}/../helper.xml" target="runBirtPerformance" >
			<property name="runner.dir" value="${eclipse.build.configs}/birt.tests/test.scripts" />
		</ant>
		<ant antfile="${eclipse.build.configs}/../helper.xml" target="InformPerformance" >
			<property name="runner.dir" value="${eclipse.build.configs}/birt.tests/test.scripts" />
		</ant>
	</target>
	
	<target name="buildBirtTestFeature" unless="skip.build.testsuite">
        <tstamp prefix="timestamp">
            <format property="testsuite.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.testsuite.start}]-BIRT test feature build started" file="${basedir}/monitor.log"/>
		
		<ant antfile="build.xml" dir="${basedir}">
			<property name="component" value="${eclipse.build.configs}/birt.tests" />
		</ant>
		
        <tstamp prefix="timestamp">
            <format property="testsuite.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.testsuite.end}]-BIRT test feature build finished" file="${basedir}/monitor.log"/>
		
	</target>
	
	<target name="buildBirtWtpFeature" unless="skip.build.WTP">
		<ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="generate">
			<property name="builder" value="${eclipse.build.configs}/birt.wtp" />
		</ant>
		<ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="process">
			<property name="builder" value="${eclipse.build.configs}/birt.wtp" />
		</ant>		
		<ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="assemble">
			<property name="builder" value="${eclipse.build.configs}/birt.wtp" />
		</ant>		
		<ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="package">
			<property name="builder" value="${eclipse.build.configs}/birt.wtp" />
		</ant>
		<ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="postBuild">
			<property name="builder" value="${eclipse.build.configs}/birt.wtp" />
		</ant>
		

		<antcall target="signWTPJars"/>

		<!-- unpack BIRT wtp integration feature -->
		
		<mkdir dir="${buildDirectory}/wtptmpsite"/>
		<mkdir dir="${buildDirectory}/wtptmpsite/new"/>
		<property name="wtptmpsite" value="${buildDirectory}/wtptmpsite"/>
		
		<exec executable="unzip" dir="${buildDirectory}/${buildId}">
			<arg line="-o -q birt-wtp-integration-sdk-${package.version}.zip -d ${wtptmpsite}" />
		</exec>
		
		<unpackUpdateJars site="${wtptmpsite}/eclipse" output="${wtptmpsite}/new/eclipse"/>
		
		<copy todir="${wtptmpsite}/new/eclipse" failonerror="false">
			<fileset dir="${baseLocation}/../PackageFiles/template/legal" includes="epl-v10.html,notice.html"/>
		</copy>
		
		<exec executable="zip" dir="${wtptmpsite}/new">
			<arg line="-q ${postingDirectory}/${buildId}/birt-wtp-integration-sdk-${package.version}.zip -r eclipse" />
		</exec>
		
        <!--copy wtp packages to upload area-->
		<!--echo message="start copying birt-wtp-integration-sdk-*.zip to download area..."/>
        <copy todir="${test.dir}/../../downloads/${package.version}" failonerror="false" overwrite="true">
	        <fileset dir="${postingDirectory}/${buildId}" >
                <include name="birt-wtp-integration-sdk-${package.version}.zip"/>
            </fileset>
	    </copy>
		<antcall target="renameBirtWtpPackage"/-->
			
	</target>
	
	<target name="verifyCompile">
		<!-- verify compile result -->
		<ant antfile="${eclipse.build.configs}/../helper.xml" target="verifyCompile" />
		
        <!--copy all packages to upload area-->
        <tstamp prefix="timestamp">
            <format property="copy.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.copy.start}]-start copying to download area..." file="${basedir}/monitor.log"/>
	    <echo message="                          from dir: ${postingDirectory}/${buildId}" file="${basedir}/monitor.log"/>
        <copy todir="${test.dir}/../../downloads/${package.version}" failonerror="false" overwrite="true">
	        <fileset dir="${postingDirectory}/${buildId}" >
                <include name="*.zip"/>
                <include name="*.txt"/>
                <include name="*.gz"/>
            </fileset>
	        <fileset dir="${buildDirectory}" >
                <include name="directory.txt"/>
		    </fileset>
            <fileset file="monitor.properties"/>
	    </copy>
		
		<antcall target="renameBirtPackage"/>
        
		<antcall target="sendNotification"/> 
	</target>
	
	<target name="buildBirtThirdPartyFeature">
        <tstamp prefix="timestamp">
            <format property="3rd.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.3rd.start}]-Third party feature building started" file="${basedir}/monitor.log"/>
		<ant antfile="build.xml" dir="${basedir}">
			<property name="component" value="${eclipse.build.configs}/birt.third.party" />
		</ant>
        <tstamp prefix="timestamp">
            <format property="3rd.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[timestamp.3rd.end]-Third party feature building finished" file="${basedir}/monitor.log"/>
	</target>
	<!-- - - - - - - - - - - - - - - - - - 
          target: buildBirtRCPFeature                      
         - - - - - - - - - - - - - - - - - -->
    <target name="buildBirtRCPFeature">
        <tstamp prefix="timestamp">
            <format property="rcp.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
    	<echo message="[${timestamp.rcp.start}]-Export BIRT RCP product started" file="${basedir}/monitor.log"/>
    	
    	<ant antfile="productBuild.xml" dir="${eclipse.pdebuild.scripts}/productBuild">
    		<property name="builder" value="${eclipse.build.configs}/birt.rcp"/>
    		<property name="product" value="${buildDirectory}/plugins/org.eclipse.birt.report.designer.ui.rcp/BIRT.product" />
    	</ant>
        <tstamp prefix="timestamp">
            <format property="rcp.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
    	<echo message="[${timestamp.rcp.end}]-Export BIRT RCP product finished" file="${basedir}/monitor.log"/>
    </target>

	<target name="fetchBirtWtpFeature">
        <tstamp prefix="timestamp">
            <format property="wtp.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.wtp.start}]-Fetch birt wtp integration feature started" file="${basedir}/monitor.log"/>
		
        <ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="preBuild">
            <property name="builder" value="${eclipse.build.configs}/birt.wtp" />
        </ant>
        <ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="fetch">
            <property name="builder" value="${eclipse.build.configs}/birt.wtp" />
        </ant>
        <tstamp prefix="timestamp">
            <format property="wtp.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.wtp.end}]-Fetch birt wtp integration feature finished" file="${basedir}/monitor.log"/>
	</target>
	
	<target name="fetchRCP">
        <tstamp prefix="timestamp">
            <format property="getrcp.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.getrcp.start}]-Fetch birt rcp plugin started" file="${basedir}/monitor.log"/>
		
        <ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="preBuild">
            <property name="builder" value="${eclipse.build.configs}/birt.designer.rcp" />
        </ant>
        <ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="fetch">
            <property name="builder" value="${eclipse.build.configs}/birt.designer.rcp" />
        </ant>
		
        <tstamp prefix="timestamp">
            <format property="getrcp.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.getrcp.end}]-Fetch birt rcp plugin finished" file="${basedir}/monitor.log"/>
	</target>
	
	<target name="BuildChartViewer">
        <tstamp prefix="timestamp">
            <format property="getchartviewer.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.getchartviewer.start}]-Fetch birt chart viewer started" file="${basedir}/monitor.log"/>
		<ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="preBuild">
			<property name="builder" value="${eclipse.build.configs}/birt.chart.viewer" />
		</ant>
		<ant antfile="build.xml" dir="${eclipse.pdebuild.scripts}" target="fetch">
			<property name="builder" value="${eclipse.build.configs}/birt.chart.viewer" />
		</ant>
		
        <tstamp prefix="timestamp">
            <format property="getchartviewer.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.getchartviewer.end}]-Fetch birt chart viewer finished" file="${basedir}/monitor.log"/>
	</target>
	
	<target name="buildBirtNLFeature">
		<tstamp prefix="timestamp">
            <format property="nl.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
        <echo message="[${timestamp.nl.start}]-BIRT nl feature build started" file="${basedir}/monitor.log"/>

		<property name="NLtmpsite" value="${buildDirectory}/NLtmpsite"/>
        <ant antfile="build.xml" dir="${basedir}">
        	<property name="component" value="${eclipse.build.configs}/birt.nl" />
        	<property name="fetchTag" value="HEAD" />
        	<property name="forceContextQualifier" value="${buildId}"/>
    		<property name="generateFeatureVersionSuffix" value="false"/>
        </ant>	
		
		<tstamp prefix="timestamp">
            <format property="nl.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>		
        <echo message="[${timestamp.nl.end}]-BIRT nl feature build finished" file="${basedir}/monitor.log"/>		
		<echo message="[${timestamp.nl.end}]-BIRT RCP nl feature build started" file="${basedir}/monitor.log"/>
		
		<ant antfile="build.xml" dir="${basedir}">
			<property name="component" value="${eclipse.build.configs}/birt.rcp.nl" />
        	<property name="fetchTag" value="HEAD" />
        	<property name="forceContextQualifier" value="${buildId}"/>
    		<property name="generateFeatureVersionSuffix" value="false"/>
		</ant>
		
		<tstamp prefix="timestamp">
            <format property="rcp.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
		<echo message="[${timestamp.rcp.end}]-BIRT RCP feature build finished" file="${basedir}/monitor.log"/>		
        <echo message="[${timestamp.rcp.end}]-BIRT-DTP nl feature build started" file="${basedir}/monitor.log"/>
		
        <ant antfile="build.xml" dir="${basedir}">
        	<property name="component" value="${eclipse.build.configs}/birt.dtp.nl" />
        	<property name="fetchTag" value="HEAD" />
        	<property name="forceContextQualifier" value="${buildId}"/>
    		<property name="generateFeatureVersionSuffix" value="false"/>
        </ant>
		
		<tstamp prefix="timestamp">
            <format property="dtp.nl.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
        <echo message="[${timestamp.dtp.nl.end}]-BIRT-DTP nl feature build finished" file="${basedir}/monitor.log"/>		
        <echo message="[${timestamp.dtp.nl.end}]-BIRT-DTP sybase nl feature build started" file="${basedir}/monitor.log"/>
		
        <ant antfile="build.xml" dir="${basedir}">
        	<property name="component" value="${eclipse.build.configs}/birt.dtp.sybase.nl" />
        	<property name="fetchTag" value="HEAD" />
        	<property name="forceContextQualifier" value="${buildId}"/>
    		<property name="generateFeatureVersionSuffix" value="false"/>
        </ant>
		
		<tstamp prefix="timestamp">
            <format property="sybase.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
        <echo message="[${timestamp.sybase.end}]-BIRT-DTP sybase nl feature build finished" file="${basedir}/monitor.log"/>
		
		<mkdir dir="${NLtmpsite}"/>
		<mkdir dir="${NLtmpsite}/new"/>
		<unzip src="${buildDirectory}/${buildId}/birt-nl-${package.version}.zip" dest="${NLtmpsite}"/>
		<unzip src="${buildDirectory}/${buildId}/birt-dtp-nl-${package.version}.zip" dest="${NLtmpsite}"/>
		<unzip src="${buildDirectory}/${buildId}/birt-rcp-nl-${package.version}.zip" dest="${NLtmpsite}"/>
		<unzip src="${buildDirectory}/${buildId}/birt-dtp-sybase-nl-${package.version}.zip" dest="${NLtmpsite}"/>
			
		<unpackUpdateJars site="${NLtmpsite}/eclipse" output="${NLtmpsite}/new/eclipse"/>
		<zip destfile="${buildDirectory}/${buildId}/birt-all-nl-${package.version}.zip">
             <fileset dir="${NLtmpsite}/new/eclipse" includes="features/**"/>
             <fileset dir="${NLtmpsite}/new/eclipse" includes="plugins/**"/>
        </zip>
		<ant antfile="${eclipse.build.configs}/../helper.xml" target="buildLanguagePack" />
	</target>
	
	<target name="buildUpdateSite" if="updateSite">
		<ant antfile="${eclipse.build.configs}/../helper.xml" target="buildUpdateJars" />
	</target>
	
	<target name="unpackUpdateJarsForPackaging">

		<property name="tmpsite" value="${buildDirectory}/tmpsite" />
	
		<mkdir dir="${tmpsite}/new/eclipse/features" />
		<mkdir dir="${tmpsite}/new/eclipse/plugins" />

		<!-- BIRT framework $ OSGI package -->
		<exec executable="unzip" dir="${buildDirectory}/${buildId}">
			<arg line="-q birt-report-framework-sdk-${package.version}.zip -d ${tmpsite}" />
		</exec>
	    <exec executable="unzip" dir="${buildDirectory}/${buildId}">
	        <arg line="-o -q birt-osgi-${package.version}.zip -d ${tmpsite}" />
	    </exec>
		<!-- BIRT third party -->

		<exec executable="unzip" dir="${buildDirectory}/${buildId}">
			<arg line="-o -q birt-third-party-${package.version}.zip -d ${tmpsite}" />
		</exec>

		<!-- backup un-signed and packed version -->
		<zip destfile="${buildDirectory}/birt-all-${package.version}.bak.zip">
             <fileset dir="${tmpsite}" includes="eclipse/**"/>
             <fileset dir="${eclipse.build.configs}/../../extras" includes="pack.properties"/>
        </zip>

		<!-- Sign packed features and plugins. 
		Download signed features and plugins back to replace ${tmpsite}/eclipse.
		Back signed features and plugins as update site jars 
		-->
		<antcall target="signBIRTJars"/>

		<!-- unpack features and plugins -->		
		<unpackUpdateJars site="${tmpsite}/eclipse" output="${tmpsite}/new/eclipse"/>

		<exec executable="zip" dir="${tmpsite}/new">
			<arg line="-q ${buildDirectory}/birt-all-${package.version}.zip -r eclipse" />
		</exec>
		
		<copy todir="${buildDirectory}/${buildId}" >
			<fileset dir="${tmpsite}/new">
				<include name="eclipse/**"/>
			</fileset>
		</copy>
		
	</target>

	<target name="signWTPJars" if="sign">
		
		<antcall target="SignJars">
			<param name="source.dir" value="${buildDirectory}/${buildId}"/>
			<param name="source.name" value="birt-wtp-integration-sdk-${package.version}.zip"/>
			<param name="target.dir" value="${buildDirectory}/${buildId}"/>
			<param name="target.name" value="birt-wtp-integration-sdk-${package.version}.sign.zip"/>
		</antcall>
		
		<move file="${buildDirectory}/${buildId}/birt-wtp-integration-sdk-${package.version}.sign.zip"
		      tofile="${buildDirectory}/${buildId}/birt-wtp-integration-sdk-${package.version}.zip" 
		      overwrite="true"/>
		
	</target>
	
	<target name="signBIRTJars" if="sign">
		
		<antcall target="SignJars">
			<param name="source.dir" value="${buildDirectory}"/>
			<param name="source.name" value="birt-all-${package.version}.bak.zip"/>
			<param name="target.dir" value="${buildDirectory}"/>
			<param name="target.name" value="birt-all-${package.version}.sign.zip"/>
		</antcall>
		
        <delete dir="${tmpsite}" failonerror="false" />
        <unzip src="${buildDirectory}/birt-all-${package.version}.sign.zip" dest="${tmpsite}"/>
 
	</target>
	
    <target name="SignJars">
    	
        <tstamp prefix="timestamp">
            <format property="upload" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
     	<echo message="[${timestamp.upload}]-Upload ${source.name} to build.eclipse.org started" file="${basedir}/monitor.log"/>

    	<scp todir="${username.sign}:${password.sign}@${hostname.sign}:${home.dir}" trust="true">
            <fileset dir="${source.dir}" includes="${source.name}"/>
        </scp>

        <tstamp prefix="timestamp">
            <format property="sign" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
     	<echo message="[${timestamp.sign}]-Upload ended. Wait for 30 mins for jarsigning..." file="${basedir}/monitor.log"/>

        <sshexec host="${hostname.sign}" username="${username.sign}" password="${password.sign}" trust="true"
             command="cd ${sign.dir};cp ${home.dir}/${source.name} ./;sign  ${source.name} nomail;"/>
        <sleep minutes="30"/>

    	<tstamp prefix="timestamp">
            <format property="download" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
     	<echo message="[${timestamp.download}]-Download signed jars started" file="${basedir}/monitor.log"/>
    	
        <scp localtofile="${target.dir}/${target.name}" trust="true"
           file="${username.sign}:${password.sign}@${hostname.sign}:${sign.dir}/${source.name}"/>

    	<tstamp prefix="timestamp">
            <format property="download.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
     	<echo message="[${timestamp.download.end}]-Download signed jars ended. Compare signed jars with unsigned." file="${basedir}/monitor.log"/>
    	
        <condition property="CompareSignPack" value="true">
            <filesmatch file1="${source.dir}/${source.name}"
                        file2="${target.dir}/${target.name}"/>
        </condition>
    	
    	<antcall target="DownloadSignedPackAgain">
    		<param name="source.name" value="${source.name}"/>
    		<param name="target.name" value="${target.name}"/>
    	    <param name="target.dir" value="${target.dir}"/>
    	</antcall>

    	<tstamp prefix="timestamp">
            <format property="package" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
     	<echo message="[${timestamp.package}]-Packaging starts" file="${basedir}/monitor.log"/>

    </target>

    <target name="DownloadSignedPackAgain" if="CompareSignPack">
    	
    	<tstamp prefix="timestamp">
            <format property="download.again" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
     	<echo message="[${timestamp.download.again}]-Compare fails. Wait 10 mins to download again..." file="${basedir}/monitor.log"/>

        <sleep minutes="10"/>
    	
    	<tstamp prefix="timestamp">
            <format property="download.again.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
        <echo message="[${timestamp.download.again}]-Download signed package started" file="${basedir}/monitor.log"/>
    	
        <scp localtofile="${target.dir}/${target.name}" trust="true"
             file="${username.sign}:${password.sign}@${hostname.sign}:${sign.dir}/${source.name}"/>
    	
    	<tstamp prefix="timestamp">
            <format property="download.again.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
        <echo message="[${timestamp.download.again.end}]-Download signed package ended" file="${basedir}/monitor.log"/>
 
    </target>

	<target name="integrateBirtFeatures" />


	<target name="package">
		<ant antfile="package.xml" dir="${eclipse.pdebuild.scripts}">
			<property name="packagingInfo" value="${packagingInfo}" />
			<property name="assemblyTempDir" value="${packagingInfo}/jartmp" />
		</ant>
	</target>
	
    <target name="buildBirtWebViewer">
    	<tstamp prefix="timestamp">
            <format property="webviewer.start" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
    	<echo message="[${timestamp.webviewer.start}]-Build BIRT web viewer started" file="${basedir}/monitor.log"/>
        <ant antfile="${eclipse.build.configs}/../helper.xml" target="BuildWebViewer" />
    	<tstamp prefix="timestamp">
            <format property="webviewer.end" pattern="yyyy-MM-dd HH:mm:ss" locale="en" />
        </tstamp>
    	<echo message="[${timestamp.webviewer.end}]-Build BIRT web viewer finished" file="${basedir}/monitor.log"/>
    </target>

	<target name="generateJavaCrossReference" if="genJavaDoc">
        <ant antfile="${eclipse.build.configs}/../../extras/CrossReferenceGenerator.xml" 
        	target="generateJavaCrossReference" >
        </ant>
	</target>

	<target name="generateDocumentCheck" if="genJavaDoc">
        <ant antfile="${eclipse.build.configs}/../../extras/CrossReferenceGenerator.xml" 
        	target="generateDocumentCheck" >
        </ant>
	</target>
	
    <target name="generateJavaDoc" if="genJavaDoc">
        <ant antfile="${eclipse.build.configs}/../../extras/antJavadoc.xml"/>
    </target>

	
</project>
